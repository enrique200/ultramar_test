{% extends 'base.html' %}

{% block content %}
{% if messages %}
<div class="alert alert-dismissible fade show" role="alert">
    {% for message in messages %}
    <div class="alert alert-{% if message.tags %}{{ message.tags }}{% endif %} alert-dismissible text-white" role="alert">
      <span class="text-sm text-dark">{{ message }}</span>
      <button type="button" class="btn-close text-lg py-3 opacity-10" data-bs-dismiss="alert" aria-label="Close">
        <span aria-hidden="true">&times;</span>
      </button>
    </div>
    {% endfor %}
</div>
{% endif %}
<div class="container mt-4">
    <h2>Import Booking Data</h2>
    <p>Please upload an Excel file (.xls, .xlsx) to import bookings.</p>

    <form method="post" enctype="multipart/form-data" class="mb-3" id="importForm">
        {% csrf_token %}
        <div class="input-group mb-3">
            <input type="file" name="excel_file" class="form-control" id="inputGroupFile02" required>
            <label class="input-group-text" for="inputGroupFile02">Upload</label>
        </div>
        <button type="submit" class="btn btn-primary">Import</button>
    </form>

    <a href="{% url 'booking_list' %}" class="btn btn-secondary">Back to List</a>
</div>

<script>
document.getElementById('importForm').onsubmit = function(event) {
    var fileInput = document.getElementById('inputGroupFile02');
    if (fileInput.files.length === 0) {
        alert('Please select a file to import.');
        event.preventDefault(); // Stop the form from submitting
    }
};
</script>

{% endblock %}
